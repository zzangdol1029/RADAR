# 윈도우 크기 분석 및 권장사항

## 현재 설정 분석

### 로그 특성 분석 결과
- **평균 로그 간격**: 1.46초
- **1분 내 예상 로그 개수**: 약 41개
- **5분 내 예상 로그 개수**: 약 205개

### 현재 설정
```yaml
window_size: 20          # 로그 개수 기준
window_time: 300         # 5분 (300초)
```

## 문제점

### 1. 윈도우 크기 20의 문제
- **시간 범위**: 20개 × 1.46초 ≈ **약 29초** 분량의 로그만 포함
- **컨텍스트 손실**: 관련된 로그가 다음 세션으로 분리될 수 있음
- **빠른 세션 생성**: 시간 윈도우(5분)보다 로그 개수(20개)가 먼저 도달하여 세션이 생성됨

### 2. 실제 동작
현재 코드는 **두 조건 중 하나라도 만족하면 세션을 완성**하므로:
- 20개 로그가 먼저 도달 → 약 29초마다 세션 생성
- 5분 시간 윈도우는 거의 사용되지 않음

## 권장사항

### 옵션 1: 윈도우 크기 증가 (권장)
```yaml
window_size: 50          # 약 1분 분량 (50개 × 1.46초 ≈ 73초)
window_time: 300         # 5분 유지
```
**장점**: 
- 더 긴 컨텍스트 유지
- LogBERT 모델이 더 많은 패턴 학습 가능
- 실제 요청 흐름을 더 잘 반영

### 옵션 2: 시간 기반 우선
```yaml
window_size: 100         # 충분히 크게 설정
window_time: 180         # 3분으로 단축
```
**장점**:
- 시간 기반으로 세션 생성
- 일정한 시간 범위의 로그 그룹화

### 옵션 3: 균형잡힌 설정 (추천)
```yaml
window_size: 30          # 약 44초 분량
window_time: 120         # 2분
```
**장점**:
- 로그 개수와 시간 모두 고려
- 적절한 세션 크기 유지
- 메모리 효율적

## LogBERT 모델 관점

### 시퀀스 길이 고려
- **max_seq_length: 512** (현재 설정)
- **권장 시퀀스 길이**: 64~256
- **윈도우 크기 20**: 모델 학습에 충분하지만, 더 긴 패턴 학습을 위해 30~50 권장

### 실험적 권장값
```yaml
window_size: 40          # 약 1분 분량, 모델 학습에 적합
window_time: 180         # 3분, 실용적인 시간 범위
max_seq_length: 256     # 메모리 효율적
```

## 서비스별 차이 고려

### Gateway 로그
- **높은 빈도**: 짧은 시간 내 많은 요청
- **권장**: window_size=50, window_time=120

### Manager/Research 로그
- **중간 빈도**: 일반적인 애플리케이션 로그
- **권장**: window_size=30, window_time=180

### Eureka 로그
- **낮은 빈도**: 정기적인 하트비트 (1분마다)
- **권장**: window_size=20, window_time=300

## 최종 권장 설정

```yaml
# preprocessing_config.yaml
window_size: 40          # 약 1분 분량의 로그
window_time: 180         # 3분 시간 윈도우
max_seq_length: 256     # 메모리 효율적인 시퀀스 길이
```

이 설정은:
- ✅ 적절한 컨텍스트 유지
- ✅ 메모리 효율적
- ✅ LogBERT 학습에 적합
- ✅ 대부분의 서비스에 적용 가능

